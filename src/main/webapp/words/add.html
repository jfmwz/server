<!DOCTYPE html>
<!--
  ~ Copyright 2012 eiennohito
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<html>
<body class="lift:content_id=main">
<div id="main" class="lift:surround?with=default;at=content">
  <head_merge>
    <script language="JavaScript" class="lift:AddWord.asyncFunc">
      function displaySimilar(text) {}
    </script>
    <script language="JavaScript">
      var executing = false;
      var next = null;

      function send() {
        if (!executing && next != null) {
          var n = next;
          next = null;
          executing = true;
          window.setTimeout(
            function() {
              displaySimilar(n)
            },
            150);
        }
      }

      function finish() {
        executing = false;
        window.setTimeout(send, 250)
      }

      $().ready(function() {
        var f = function(e) {
                  next = $(e.target).val();
                  send();
                };

        $("#word-area").change(f).keyup(f)
      });

      $().ready(function () {
        $("form input, form select").live('keypress', function (e) {
        if ($(this).parents('form').find('button[type=submit].default, input[type=submit].default').length <= 0)
          return true;
        if ((e.which && e.which == 13) || (e.keyCode && e.keyCode == 13)) {
          $(this).parents('form').find('button[type=submit].default, input[type=submit].default').click();
          return false;
        } else {
          return true;
        }
      });
        $('#parse-btn').click(function() {
          var area = $('#parse-area');
          var data = area.val();
          $.ajax({
            url: "../api/juman/unique_words",
            type: "POST",
            contentType: "text/plain; charset=UTF8",
            dataType: "text",
            processData: false,
            data: data
          }).done(function(text) {
            var already = $('#word-area');
            var str = text + "\n" + already.val();
            $('#word-area').val(str);
            area.val("");
          });
        });
      });
    </script>
    <style>
      .good {
        background-color: #98fb98;
      }

      .bad {
        background-color: #ffc0cb;
      }

      .word-container {
        width: 100px;
      }

      .already-present {
        background-color: orange;
      }

      .reading {}

      .writing {}

      div.word-cell {
        display: block;
        float: left;
      }

      div.dic-cell {
        display: block;
        float: left;
      }

      div#similar-words {
        margin-left: 40px;
        border-left: 1px brown dotted;
      }

    </style>
  </head_merge>
  <div>
    <p>To add new words enter them into form below, one per line.</p>
  </div>
  <div class="column">
    <div id="stats"></div>
    <div>
      <table class="lift:AddWord.addField" xmlns:word="word-data">
        <tr>
          <td>Paste text here</td>
          <td><textarea id="parse-area"></textarea></td>
        </tr>
        <tr>
          <td></td>
          <td><button id="parse-btn">Parse</button> </td>
        </tr>
        <tr>
          <td>Add words here</td>
          <td><word:data><textarea id="word-area"></textarea></word:data></td>
        </tr>
        <tr>
          <td><word:all></word:all></td>
          <td><word:nonproblem></word:nonproblem></td>
        </tr>
      </table>
      <div class="lift:AddWord.anotherSnippet"></div>
      <div id="asdf"></div>
    </div>
  </div>
  <div class="column">
    <table id="similar-words">
    </table>
  </div>
</div>
</body>
</html>

